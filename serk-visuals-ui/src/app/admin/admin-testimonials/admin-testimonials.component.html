<section class="container section">
  <header class="head">
    <h1>Admin Testimonials</h1>
  </header>

  <form class="card" (ngSubmit)="submit()" [formGroup]="form" novalidate>
    <h2 class="card__title">
      {{ editingId() ? 'Edit testimonial' : 'Add new testimonial' }}
    </h2>

    <div class="grid form-grid">
      <label>
        <span class="lbl">Author *</span>
        <input formControlName="author" placeholder="Daniel Haile" />
      </label>

      <label>
        <span class="lbl">Role / Title</span>
        <input formControlName="role" placeholder="Bride, CEO, etc." />
      </label>

      <label class="full">
        <span class="lbl">Quote *</span>
        <textarea
          formControlName="quote"
          rows="4"
          placeholder="They captured our day perfectly…"
        ></textarea>
      </label>

      <label>
        <span class="lbl">Published</span>
        <label class="switch">
          <input type="checkbox" formControlName="published" />
          <span>Visible on site</span>
        </label>
      </label>

      <label>
        <span class="lbl">Order</span>
        <input type="number" formControlName="order" placeholder="0" />
      </label>

      <label class="file full">
        <span class="lbl">Avatar (optional)</span>
        <input id="avatar" type="file" accept="image/*" (change)="onFile($event)" />
      </label>
    </div>

    <div class="actions">
      <button class="btn primary" type="submit">
        {{ editingId() ? 'Update' : 'Create' }}
      </button>
      <button class="btn" type="button" (click)="cancelEdit()" *ngIf="editingId()">
        Cancel
      </button>
    </div>
  </form>

  <div class="skeleton" *ngIf="loading()">Loading…</div>
  <div class="alert alert--error" *ngIf="!loading() && error()">{{ error() }}</div>

  <div class="grid-list" *ngIf="!loading() && !error()">
    <article class="tile" *ngFor="let it of items(); trackBy: trackById">
      <div class="tile__row">
        <img
          class="avatar"
          [src]="it.avatar || 'https://placehold.co/96x96?text=%20'"
          [alt]="it.author"
          width="96"
          height="96"
        />
        <div class="tile__meta">
          <h4 class="tile__title">{{ it.author }}</h4>
          <p class="muted">{{ it.role || '—' }}</p>
          <p class="muted small" *ngIf="it.order !== undefined">Order: {{ it.order }}</p>
          <p class="muted small" *ngIf="it.published === false">
            <span class="badge">Unpublished</span>
          </p>
        </div>
      </div>

      <blockquote class="quote">“{{ it.quote }}”</blockquote>

      <div class="tile__actions">
        <button class="btn sm" (click)="edit(it)">Edit</button>
        <button class="btn sm danger" (click)="remove(it)">Delete</button>
      </div>
    </article>
  </div>

  <nav class="pager" *ngIf="!loading() && pages() > 1" aria-label="Pagination">
    <button class="btn" [disabled]="page()===1" (click)="goto(page()-1)">Prev</button>
    <span>Page {{ page() }} of {{ pages() }}</span>
    <button class="btn" [disabled]="page()===pages()" (click)="goto(page()+1)">Next</button>
  </nav>
</section>
